# –ú–∏–≥—Ä–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–æ–≤

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã –¥–ª—è –ª–∏–¥-–º–∞–≥–Ω–∏—Ç–æ–≤ —á–µ—Ä–µ–∑ Telegram –≤–º–µ—Å—Ç–æ URL-—Å—Å—ã–ª–æ–∫.

### –ù–æ–≤–æ–µ –ø–æ–ª–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
- `lead_magnets.telegram_file_id` (TEXT, nullable) - ID —Ñ–∞–π–ª–∞ –≤ Telegram –¥–ª—è –ø—Ä—è–º–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: Bash —Å–∫—Ä–∏–ø—Ç (–°–ê–ú–´–ô –ü–†–û–°–¢–û–ô) ‚≠ê

```bash
cd ~/Lead_bot
bash migrate.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Python —Å–∫—Ä–∏–ø—Ç (–±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

```bash
cd ~/Lead_bot
python3 scripts/migrate_add_telegram_file_id.py
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ SQL —Ñ–∞–π–ª

```bash
cd ~/Lead_bot
sqlite3 leadbot.db < migration.sql
```

### –í–∞—Ä–∏–∞–Ω—Ç 4: –†—É—á–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ SQLite

```bash
cd ~/Lead_bot
sqlite3 leadbot.db

# –í –∫–æ–Ω—Å–æ–ª–∏ SQLite:
ALTER TABLE lead_magnets ADD COLUMN telegram_file_id TEXT;
.quit
```

### –í–∞—Ä–∏–∞–Ω—Ç 5: –û–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

```bash
cd ~/Lead_bot && sqlite3 leadbot.db "ALTER TABLE lead_magnets ADD COLUMN telegram_file_id TEXT;"
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã:

```bash
sqlite3 leadbot.db "PRAGMA table_info(lead_magnets);"
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∫–æ–ª–æ–Ω–∫—É `telegram_file_id` –≤ —Å–ø–∏—Å–∫–µ.

## üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:

```bash
systemctl restart leadbot
# –∏–ª–∏
supervisorctl restart leadbot
# –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ
pkill -f "python.*main.py"
python main.py
```

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
journalctl -u leadbot -f
# –∏–ª–∏
tail -f logs/leadbot*.log
```

–î–æ–ª–∂–Ω–æ –∏—Å—á–µ–∑–Ω—É—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ:
```
no such column: lead_magnets.telegram_file_id
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ:

1. `/admin` ‚Üí "üéÅ –õ–∏–¥-–º–∞–≥–Ω–∏—Ç—ã" ‚Üí "‚ûï –î–æ–±–∞–≤–∏—Ç—å"
2. –í–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
3. **–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª** (PDF, –¥–æ–∫—É–º–µ–Ω—Ç, —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ)
4. –§–∞–π–ª –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Å telegram_file_id –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–∞–ø—Ä—è–º—É—é

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –°—Ç–∞—Ä—ã–µ –ª–∏–¥-–º–∞–≥–Ω–∏—Ç—ã —Å URL –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- –ù–æ–≤—ã–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞–∫ —Å —Ñ–∞–π–ª–æ–º, —Ç–∞–∫ –∏ —Å URL
- –ú–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–∞ –∏ –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "table lead_magnets has no column named telegram_file_id"

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ:
```bash
python scripts/add_telegram_file_id_column.py
```

### –û—à–∏–±–∫–∞: "cannot access local variable 'LeadMagnetType'"

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏:
```bash
git pull origin main
systemctl restart leadbot
```

### –ö–æ–ª–æ–Ω–∫–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç —Å–æ–æ–±—â–∞–µ—Ç, —á—Ç–æ –∫–æ–ª–æ–Ω–∫–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –≤—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ, –º–∏–≥—Ä–∞—Ü–∏—è —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.

## üìù –ö–æ–º–º–∏—Ç—ã

- `feat: Add file upload support for lead magnets with Telegram file_id storage`
- `fix: Fix LeadMagnetType import and add migration script for telegram_file_id`

